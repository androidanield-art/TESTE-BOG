<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  
  # Garante que o servidor reconheça extensões de TypeScript como JavaScript
  <IfModule mod_mime.c>
    AddType application/javascript .ts
    AddType application/javascript .tsx
  </IfModule>

  # NÃO redireciona se o arquivo físico existir (essencial para carregar .tsx e .css)
  RewriteCond %{REQUEST_FILENAME} -f
  RewriteRule ^ - [L]

  # Se o arquivo não existir, aí sim manda para o index.html (comportamento de App)
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule . index.html [L]
</IfModule>

# Prevenção de cache para o arquivo principal durante testes
<FilesMatch "index.html">
  FileETag None
  <IfModule mod_headers.c>
    Header unset ETag
    Header set Cache-Control "max-age=0, no-cache, no-store, must-revalidate"
    Header set Pragma "no-cache"
    Header set Expires "Wed, 11 Jan 1984 05:00:00 GMT"
  </IfModule>
</FilesMatch>